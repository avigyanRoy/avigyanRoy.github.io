import React, { useState, useEffect } from "react";
import axios from "axios";
import { Link,useNavigate } from "react-router-dom";

function AskaQuestion() {
    const [title, setTitle] = useState("");
    const [qBody, setQbody] = useState("");
    const [user, setUser] = useState("");
    const up_votes = 0;
    const down_votes = 0;
    const no_of_answers = 0;
    const answers = [];
    const answer_up_votes = [];
    const answer_down_votes = [];
    const navigate= useNavigate();
    useEffect(() => {
        // Fetch the data from the backend when the component mounts
        axios
            .get("http://localhost:3001/askaquestion")
            .then((response) => {
                setUser(response.data);
            })
            .catch((error) => {
                console.log("Error while fetching data: ", error);
            });
    }, []);
    async function submitQ(e) {
        e.preventDefault();
        try {
            if(title==="" || qBody===""){
                alert("Please enter the required details.");
                throw ErrorEvent;
            }
            
            axios.post("http://localhost:3001/postquestion", {
                title, user, up_votes, down_votes, no_of_answers, qBody, answers, answer_up_votes, answer_down_votes
            })
                .then(res => {
                    
                })
                .catch(e => {
                    
                    
                    console.log(e);
                    
                });
                
                
                navigate("/home");
                
                
            
        }
        catch (e) {
            
            console.log(e);
        }
        
    }

    return (
        <div className="ask-a-question-container">
            <div className="ask-a-question-title">
                Ask a Public Question
            </div>
            <div className="question-edit-container">
                <div className="subsection-heading">Title</div>
                <div className="subsection-directions">Please be specific and imagine you're asking a question to another person.</div>
                <div className="title-input"><input type="text" placeholder="Enter the title" onChange={(e) => { setTitle(e.target.value) }}></input></div>
                <div className="subsection-heading">Explain your question and state your expectations from the answers</div>
                <div className="subsection-directions">Introduce the problem and expand on what you put in the title.</div>
                <div className="title-input"><textarea type="text" className="desc-input" placeholder="Enter the question description" onChange={(e) => { setQbody(e.target.value) }}></textarea></div>
                
                    <button className="post-question-btn" onClick={submitQ}>Post Question</button>
                
            </div>
        </div>
    );
}

export default AskaQuestion;